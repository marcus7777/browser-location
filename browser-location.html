<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../polymer/polymer.html">
<!--
  `<browser-location></browser-location>` Asks the browser of your current location
  @demo demo.html
-->
<dom-module id="browser-location">
  <template>
    <paper-button on-tap="getLocation">[[text]]</paper-button>
  </template>
</dom-module>
<script>
  Polymer({
    is: "browser-location",
    properties:{
      latitude:{
        notify:true,
      },
      longitude:{
        notify:true,
      },
      text:{
        value: "Share my location"
      },
      onceApproved:{
        value: "âŠ•"
      },
    },
    getLocation: function(){
      var that = this
      function showPosition(position) { 
        that.latitude = position.coords.latitude
        that.longitude = position.coords.longitude
        that.text = that.onceApproved
      }
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        alert("Geolocation is not supported by this browser.")
      }
    },
    ready: {
      var that = this
      if (navigator.permissions) {
        navigator.permissions.query({name:'geolocation'}).then(function(permission){
        // is geolocation granted?
        if (permission.state === "granted") {
          that.getLocation()
        }
      }
  })
</script>
